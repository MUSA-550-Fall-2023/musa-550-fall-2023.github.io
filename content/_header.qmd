---
execute: 
  echo: false
---

```{python}
import yaml
import pandas as pd
from pyprojroot.here import here
from IPython.core.display import HTML
from IPython import get_ipython

# Get week info for rendered page from folder
ip = get_ipython()
path = ip.starting_dir
slug = path.split("/")[-1] # Should be week-X
week_number = int(slug.split("-")[-1])

# Main directory
root_dir = here()

# Get the current lecture from project variables
variables = yaml.load((root_dir / "_variables.yml").open("r"), yaml.Loader)
current_lecture = variables["current_lecture"]
current_week = int(current_lecture[:-1])


# Load the schedule data
data = pd.read_csv(root_dir / "data" / "schedule-dates.csv")

html = []

# Now do the github links
html.append('<div class="assignment-header mt-2">')

disabled = ""

# Do the Github repo
url = f"https://github.com/MUSA-550-Fall-2023/{slug}"
html.append(
  f"""
  <div class="assignment-page-repo">
    <i class="fa-brands fa-github fa-md"></i>
    &nbsp;<span>View materials:</span>&nbsp;
    <a href="{url}"> MUSA-550-Fall-2023/{slug}</a>
  </div>"""
)

def get_binder_url(tag):
  """Get the binder url for this lecture."""
  lecture_number = f"{week_number}{tag}"
  return f"https://mybinder.org/v2/gh/MUSA-550-Fall-2023/week-{week_number}/HEAD?labpath=lecture-{lecture_number}.ipynb"

def get_disabled_class(tag):
  """Is this lecture disabled?"""

  lecture_number = f"{week_number}{tag}"
  disabled = ""
  if week_number > current_week:
      disabled = "disabled"
  elif (
      week_number == current_week
      and lecture_number.endswith("B")
      and current_lecture.endswith("A")
  ):
      disabled = "disabled"

  return disabled

html.append(
  f"""
  <div class="assignment-page-repo">
    <img class="binder-favicon" src="/files/binder-favicon.webp"></img>
    &nbsp;<span>Launch slides on Binder:</span>&nbsp;
    <a class="{get_disabled_class("A")}" href="{get_binder_url("A")}">
      Lecture {week_number}A
    </a>
    &nbsp;
    <a class="{get_disabled_class("B")}" href="{get_binder_url("B")}">
      Lecture {week_number}B
    </a>
  </div>"""
)

html.append("</div>")

HTML("\n".join(html))
```
